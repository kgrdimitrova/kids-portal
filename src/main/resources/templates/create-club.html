<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Club - Kids Portal</title>
    <link rel="stylesheet" href="/css/global-styles.css">
    <link rel="stylesheet" href="/css/create-club-styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One:wght@400&family=Open+Sans:wght@400;600;700&display=swap"
          rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
<!-- Header -->
<header class="portal-header">
    <div class="container">
        <div class="logo">
            <i class="fas fa-star"></i>
            <h1>Kids Portal</h1>
        </div>
        <nav class="top-nav">
            <a th:href="@{/home}" class="nav-btn">
                <i class="fas fa-home"></i>
                Home
            </a>
            <a th:href="@{/logout}" class="nav-btn">
                <i class="fas fa-right-from-bracket"></i>
                Logout
            </a>
        </nav>
    </div>
</header>

<main class="portal-main">
    <div class="container">
        <!-- Page Header -->
        <section class="page-header">
            <h2><i class="fas fa-users"></i> Create New Club</h2>
            <p>Start a new club and bring kids together around shared interests and activities!</p>
        </section>

        <!-- Create Club Form -->
        <section class="create-club-section">
            <div class="form-container">
                <form class="club-form" id="createClubForm" th:action="@{/clubs/create-club}" th:object="${clubRequest}"
                      th:method="POST">
                    <!-- Basic Information -->
                    <div class="form-section">
                        <h3><i class="fas fa-info-circle"></i> Basic Information</h3>

                        <div class="form-group">
                            <label for="clubName">Club Name *</label>
                            <input id="clubName" name="name" placeholder="Enter club name" required
                                   th:field="*{name}" type="text">
                            <p class="error-message" th:errors="*{name}" th:if="${#fields.hasErrors('name')}">Error
                                Message</p>
                        </div>

                        <div class="form-group">
                            <label for="clubDescription">Description *</label>
                            <textarea th:field="*{description}" id="clubDescription" name="description"
                                      placeholder="Describe the club, its purpose, activities, and what kids will learn or do together."
                                      rows="4" required></textarea>
                            <p class="error-message" th:errors="*{description}"
                               th:if="${#fields.hasErrors('description')}">Error Message</p>
                        </div>

                        <div class="form-group">
                            <label for="clubLocation">Location *</label>
                            <select id="clubLocation" name="location" required th:field="*{location}">
                                <option th:each="location : ${T(com.portal.kids.common.Location).values}"
                                        th:value="${location}" th:text="${location}"></option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="clubCategory">Activity Type/Category *</label>
                            <select id="clubCategory" name="category" required th:field="*{type}">
                                <option th:each="type : ${T(com.portal.kids.common.ActivityType).values}"
                                        th:value="${type}" th:text="${type}"></option>
                            </select>
                            <p class="error-message" th:if="${#fields.hasErrors('location')}" th:errors="*{location}">
                                Error Message</p>
                        </div>

                        <div class="form-group">
                            <label for="clubPicture">Picture</label>

                            <!-- Preview the current or fallback image -->
                            <!--                            <img-->
                            <!--                                    alt="Club's logo"-->
                            <!--                                    style="max-width: 200px; border-radius: 8px; display: block; margin-bottom: 8px;">-->

                            <!-- Allow manual update of the picture URL -->
                            <input type="text"
                                   id="clubPicture"
                                   name="picture"
                                   th:field="*{imageUrl}"
                                   placeholder="Paste image URL here"
                                   class="form-control">

                            <small class="text-muted">Paste a direct image URL (e.g.,
                                https://example.com/image.png)</small>
                        </div>
                        <div>
                            <button type="submit" class="btn btn-success">
                                <i class="fas fa-check"></i>
                                Create Club
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </section>
    </div>
</main>

<th:block th:insert="fragments/footer :: footer"></th:block>

<script>
    // File upload preview
    document.getElementById('clubPicture').addEventListener('change', function (e) {
        const file = e.target.files[0];
        const preview = document.getElementById('filePreview');

        if (file) {
            if (file.size > 5 * 1024 * 1024) { // 5MB limit
                showNotification('File size must be less than 5MB', 'error');
                this.value = '';
                return;
            }

            const reader = new FileReader();
            reader.onload = function (e) {
                preview.innerHTML = `
                        <div class="image-preview">
                            <img src="${e.target.result}" alt="Preview">
                            <button type="button" class="remove-image" onclick="removeImage()">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    `;
            };
            reader.readAsDataURL(file);
        }
    });

    // Form functions
    //function handleFormSubmit() {
    //    const formData = new FormData(document.getElementById('createClubForm'));
    //    const clubData = Object.fromEntries(formData.entries());

    //    // Add file if selected
    //     const pictureFile = document.getElementById('clubPicture').files[0];
    //    if (pictureFile) {
    //       clubData.picture = pictureFile.name;
    //    }
    //
    //    console.log('Club Data:', clubData);
    //    showNotification('Club created successfully!', 'success');
    //
    //    // Simulate form submission
    //     setTimeout(() => {
    //        window.location.href = 'index.html';
    //    }, 2000);
    //}

    function saveAsDraft() {
        const formData = new FormData(document.getElementById('createClubForm'));
        const clubData = Object.fromEntries(formData.entries());

        console.log('Draft Saved:', clubData);
        showNotification('Club saved as draft', 'info');
    }

    function resetForm() {
        if (confirm('Are you sure you want to reset the form? All data will be lost.')) {
            document.getElementById('createClubForm').reset();
            document.getElementById('filePreview').innerHTML = '';
            showNotification('Form reset successfully', 'info');
        }
    }

    function removeImage() {
        document.getElementById('clubPicture').value = '';
        document.getElementById('filePreview').innerHTML = '';
    }

    // Notification system
    function showNotification(message, type = 'info') {
        const notification = document.createElement('div');
        notification.className = `notification ${type}`;
        notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
                <span>${message}</span>
            `;

        document.body.appendChild(notification);

        setTimeout(() => {
            notification.classList.add('show');
        }, 100);

        setTimeout(() => {
            notification.classList.remove('show');
            setTimeout(() => {
                if (document.body.contains(notification)) {
                    document.body.removeChild(notification);
                }
            }, 300);
        }, 3000);
    }

    // Initialize page
    document.addEventListener('DOMContentLoaded', function () {
        // Animate form sections
        const sections = document.querySelectorAll('.form-section');
        sections.forEach((section, index) => {
            setTimeout(() => {
                section.style.opacity = '1';
                section.style.transform = 'translateY(0)';
            }, index * 200);
        });
    });
</script>
</body>
</html>
